import{_ as N}from"./BYdc3zRc.js";import{u as z}from"./CQW_vi0x.js";import{p as k}from"./BS_QG9T_.js";import{_ as F}from"./C5KoYXvH.js";import{d as O,O as j,F as E,r as m,L as G,k as n,y as s,z as a,C as _,D as b,A as v,G as r,B as c,g as H,E as K,H as o,I as L,_ as $}from"./CThe8rmN.js";import{u as q}from"./BTM_bmsK.js";import{s as J}from"./nvZ7vHZN.js";const Q={class:"d-flex flex-column ga-1 py-4"},U={style:{"min-width":"14rem"}},W={key:0,class:"text-primary",style:{"border-radius":"1rem"}},X={class:"text-caption"},Y={key:0,class:"text-caption"},Z={key:1,class:"text-red",style:{"border-radius":"1rem"}},ee={key:0,class:"text-caption"},te={key:1,class:"text-caption"},le={key:2,class:"text-success",style:{"border-radius":"1rem"}},se={key:0,class:"text-caption"},ae={key:3,class:"text-red d-flex align-center ga-1"},oe=O({__name:"VideoTable",setup(ie){const y=j(),{t:f}=E(),{onGetterMasterData:d}=q(),T=[{title:"Tiêu đề",key:"title",sortable:!1},{title:"Mô hình",key:"modelVideoTitle",sortable:!1},{title:"Tỷ lệ khung hình",key:"frameRateTitle",sortable:!1},{title:"Chế độ",key:"videoModeTitle",sortable:!1},{title:"Phong cách",key:"videoStyleTitle",sortable:!1},{title:"Thời lượng",key:"videoDurationTitle",align:"center",sortable:!1},{title:"Tác giả",key:"account.name",sortable:!1},{title:"Cập nhật",key:"updatedAt",sortable:!1},{title:"Trạng thái",key:"status",align:"center",sortable:!1},{title:"Thao tác",key:"action",align:"center",sortable:!1}],h=m({}),p=m(""),g=m(null),M=m(null),u=G({modelVideo:null,frameRate:null,videoMode:null,videoStyle:null,videoDuration:null,status:null}),V=n(()=>[{title:"Tất cả",value:null},...d.value["model-video"]||[]]),w=n(()=>[{title:"Tất cả",value:null},...d.value["frame-rate"]].map(e=>({title:f(e.title),value:e.value}))||[]),x=n(()=>[{title:"Tất cả",value:null},...d.value["video-mode"]].map(e=>({title:f(e.title),value:e.value}))||[]),D=n(()=>{const e=[{title:"Tất cả",value:null},...d.value["video-style"]].map(t=>({title:f(t.title),value:t.value}))||[];switch(u.videoMode){case"movie":return e.filter(t=>[null,"general","monologue","narration"].includes(t.value));case"storytelling":return e.filter(t=>[null,"general"].includes(t.value));case"short_form_video":return e.filter(t=>[null,"general","satisfying","asmr"].includes(t.value));case"my_subject":return e.filter(t=>[null,"general","testimonial"].includes(t.value));default:return e}}),C=n(()=>{const e=[{title:"Tất cả",value:null},...d.value["video-duration"]];if(u.videoMode==="movie")return e;if(["short_form_video","my_subject"].includes(u.videoMode)){const t=[null,"1","2","3","4","5","6","7"];return e.filter(i=>t.includes(i.value))}else if(["storytelling"].includes(u.videoMode)){const t=[null,"8","12","16","20","24"];return e.filter(i=>t.includes(i.value))}else return e}),I=n(()=>J.filter(e=>e.value!=="all")?.map(e=>({...e,title:f(e.title)})));async function S(e){const t={...e,state:y.path?.split("/")?.pop()||"in-progress"};p.value="load-table",await k.getAllProduct(t).then(i=>{i.data&&(h.value=i.data)}).finally(()=>{p.value=""})}const R=async e=>{!e||!e._id||(await k.saveProduct(e),await g.value?.loadItems())},A=async e=>{e.action=="reload"?R(e.item):e.action=="view"&&(e?.item?.link?window.open(e?.item?.link,"_blank"):z().onActionSetSystemPopup({type:"error",content:"Thước phim không tồn tại!"}))},B=e=>{u[e.field]=e.value};return(e,t)=>{const i=H("v-icon"),P=N;return a(),s(L,null,[_(F,{ref_key:"confirmDialogRef",ref:M},null,512),_(P,{ref_key:"dataTableRef",ref:g,filters:[{label:"Mô hình",field:"modelVideo",type:"select",items:o(V)},{label:"Tỷ lệ khung hình",field:"frameRate",type:"select",items:o(w)},{label:"Chế độ",field:"videoMode",type:"select",items:o(x)},{label:"Phong cách",field:"videoStyle",type:"select",items:o(D)},{label:"Thời lượng",field:"videoDuration",type:"select",items:o(C)},{label:"Trạng thái",field:"status",type:"select",items:o(I)}],showSelect:!1,actions:[],rowActions:o(y).path?.split("/")?.pop()==="error"?["reload","view"]:["view"],headers:T,data:o(h),loading:o(p)=="load-table",onChange:S,onAction:A,onChangeFilter:B},{"row-title":b(({item:l})=>[v("div",Q,[v("span",U,c(l.title),1),l.state==="primary"?(a(),s("div",W,[v("div",X,c(l?.lastMessage?.title),1),l?.lastMessage?.note?(a(),s("div",Y,c(l?.lastMessage?.note),1)):r("",!0)])):l.state==="error"?(a(),s("div",Z,[l?.lastMessage?.note?(a(),s("div",ee,c(l?.lastMessage?.note),1)):r("",!0),l?.lastMessage?.errorMsg?(a(),s("div",te,c(l?.lastMessage?.errorMsg),1)):r("",!0)])):l.state==="success"?(a(),s("div",le,[l?.lastMessage?.note?(a(),s("div",se,c(l?.lastMessage?.note),1)):r("",!0)])):r("",!0),l.isDelete?(a(),s("div",ae,[_(i,{size:"20"},{default:b(()=>[...t[0]||(t[0]=[K("mdi-delete-outline",-1)])]),_:1}),t[1]||(t[1]=v("span",{style:{"font-size":"0.8rem"}},"Khách hàng đã xóa video này",-1))])):r("",!0)])]),_:1},8,["filters","rowActions","data","loading"])],64)}}}),ve=$(oe,[["__scopeId","data-v-68908076"]]);export{ve as V};
