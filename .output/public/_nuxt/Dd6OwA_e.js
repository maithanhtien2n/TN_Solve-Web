import{_ as H}from"./C5KoYXvH.js";import{_ as K}from"./C0kofyO-.js";import{d as O,F as Q,L as W,r as m,o as D,y as d,H as a,C as o,E as y,B as v,A as s,D as i,g as n,z as c,I as B,W as M,N as Y,Q as b,V as z,X as J,Y as U,_ as Z}from"./CThe8rmN.js";import{p as I}from"./BS_QG9T_.js";import{u as ee,b as oe,a as te}from"./Cqk5BQ_7.js";import{d as se}from"./BrZZEpxw.js";import"./CQW_vi0x.js";const ne={key:0,class:"d-flex justify-center flex-column align-center ga-3 pt-10 pb-16"},ie={key:1},le={key:0,class:"relative d-flex"},re=["width","height"],ae=["src"],ce={class:"video-duration"},de={key:1,class:"relative"},ue={class:"absolute d-flex flex-column align-center justify-center ga-2 bg-opacity-90",style:{top:"0",left:"0",right:"0",bottom:"0"}},pe={class:"d-flex flex-column flex-1 pa-3 pt-2"},ve={class:"video-card-title font-bold line-clamp-2 cursor-pointer mb-1",style:{"line-height":"1.4rem"}},_e={class:"d-flex align-center ga-4"},me=O({__name:"index",setup(fe){const{t:k}=Q(),{width:p,isMobile:V}=ee(),_=W({search:"",page:1,limit:24}),u=m({}),f=m(""),w=m(null),C=m(null),g=async(l="")=>{f.value=l,await I.getProductMyLibrary(_).then(e=>{_.page===1?u.value=e.data:u.value={...u.value||{},docs:[...u.value?.docs||[],...e.data?.docs||[]]}}).finally(()=>{f.value=""})},$=(l,e)=>{if(l==="download-video"){se(e.video,e.title);return}else if(l==="delete-video"){C.value.show({noTransMsg:!0,message:k("Bạn có chắc chắn muốn xoá video này không?"),onConfirm:async()=>{try{await I.actionProduct({ids:[e._id],action:"delete"}),_.page=1,await g()}catch(h){console.error(h)}}});return}};return D(()=>{g("list")}),D(()=>{oe(w,async([{isIntersecting:l}])=>{l&&u.value?.docs?.length<u.value?.totalDocs&&(_.page++,g())},{threshold:1})}),te({title:k("Thư viện của tôi"),description:"Nền tảng AI giúp bạn tạo video chuyên nghiệp chỉ trong vài phút",image:"/images/page-video.png"}),(l,e)=>{const h=n("v-progress-circular"),N=H,T=n("v-skeleton-loader"),x=n("v-icon"),j=n("v-btn"),L=n("v-list-item"),P=n("v-list"),S=n("v-card"),A=n("v-menu"),R=n("router-link"),X=n("v-col"),E=n("v-row"),F=K;return a(f)==="list"?(c(),d("div",ne,[o(h,{width:"2",size:"40",color:"primary",indeterminate:""}),y(" "+v(l.$t("Đang tải dữ liệu...")),1)])):(c(),d("div",ie,[o(N,{ref_key:"confirmDialogRef",ref:C},null,512),e[3]||(e[3]=s("div",{class:"mb-4"},[s("span",{class:"text-error"}," ⚠️ Lưu ý: Thời gian lưu trữ cho video đã tạo là 12 giờ. Xin quý khách vui lòng tải xuống và lưu trữ để tránh mất mát dữ liệu. ")],-1)),o(E,{dense:a(V)},{default:i(()=>[(c(!0),d(B,null,M(a(u).docs,(t,q)=>(c(),Y(X,{key:q,lg:"4",md:"6",sm:"12",cols:"12"},{default:i(()=>[o(R,{class:"d-flex cursor-pointer un-select video-card",style:{"border-radius":"6px","box-shadow":"rgba(0, 0, 0, 0.05) 0px 0px 0px 1px"},to:`/video/${t._id}`},{default:i(()=>[t.state==="success"&&t.video?(c(),d("div",le,[(c(),d("video",{class:"cursor-pointer bg-black",style:b([{"border-radius":"6px 0 0 6px"},t.frameRate==="Khổ ngang (16:9)"?{"object-fit":"cover"}:{}]),key:t.video,width:a(p)>650?160:140,height:a(p)>650?101.25:90},[s("source",{src:t.video,type:"video/mp4"},null,8,ae)],12,re)),s("span",ce,v(t.videoDuration),1)])):t.state==="primary"?(c(),d("div",de,[o(T,{style:b([{"border-radius":"6px 0 0 6px"},{width:a(p)>650?"160px":"140px",height:a(p)>650?"101.25px":"90px"}])},null,8,["style"]),s("div",ue,[o(x,{size:"24",color:"blue"},{default:i(()=>[...e[1]||(e[1]=[y("mdi-progress-helper",-1)])]),_:1})])])):(c(),d("div",{key:2,class:"d-flex align-center justify-center cursor-pointer ga-1 bg-grey-lighten-3",style:b([{"border-radius":"6px 0 0 6px"},{width:a(p)>650?"160px":"140px",height:a(p)>650?"101.25px":"90px"}])},[o(x,{size:"24",color:"error"},{default:i(()=>[...e[2]||(e[2]=[y("mdi-alert-circle-outline",-1)])]),_:1})],4)),s("div",pe,[s("h4",ve,v(t.title),1),s("small",null,v(t.createdAt),1)]),o(A,{location:"bottom right"},{activator:i(({props:r})=>[o(j,J({ref_for:!0},r,{size:"40",variant:"text",icon:"mdi-dots-vertical",onClick:e[0]||(e[0]=U(()=>{},["prevent","stop"]))}),null,16)]),default:i(()=>[o(S,{"min-width":"200"},{default:i(()=>[o(P,null,{default:i(()=>[(c(),d(B,null,M([{title:"Tải video",value:"download-video",icon:"mdi-tray-arrow-down"},{title:"Xoá video",value:"delete-video",icon:"mdi-delete-outline"}],(r,G)=>o(L,{key:G,value:r.value,class:z({disabled:t.state==="primary"||r.value==="download-video"&&t.state==="error"}),onClick:ge=>$(r.value,t)},{default:i(()=>[s("div",_e,[o(x,{icon:r.icon,color:`${r.value==="delete-video"?"red":""}`},null,8,["icon","color"]),s("label",{class:z(["cursor-pointer",{"text-red":r.value==="delete-video"}])},v(l.$t(r.title)),3)])]),_:2},1032,["value","class","onClick"])),64))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))),128)),s("div",{ref_key:"loadMore",ref:w},null,512)]),_:1},8,["dense"]),o(F,{style:{"margin-top":"2rem"}})]))}}}),De=Z(me,[["__scopeId","data-v-25ab6b44"]]);export{De as default};
