import{a as J,_ as Y,b as Z}from"./B6LH8quO.js";import{d as L,O as j,u as q,S as Q,r as M,k,o as F,g as l,y as x,z as u,C as n,N as _,G as U,D as o,H as t,$,I as P,W as G,A as m,B as b,X as ee,F as te,E as oe,a4 as ne,_ as ae}from"./CThe8rmN.js";import{u as H}from"./Cqk5BQ_7.js";import{u as K}from"./CQW_vi0x.js";import{E as i}from"./C4IxTLi6.js";import{u as re}from"./BTM_bmsK.js";const ie={class:"d-flex flex-column"},le=L({__name:"DrawerSystem",setup(O,{expose:A}){const v=j(),h=q(),f=Q(),{width:R,isMobile:S}=H(),{onGetterUserData:s}=K(),d=M(!1),g=M([]);k(()=>v.meta.layout||""),k(()=>v.name?.toString().split("___")[0]);const y=k(()=>[{title:"Tổng quan",icon:"mdi-view-dashboard-outline",route:"/admin"},{role:[i.ADMIN],title:"Tài khoản",icon:"mdi-account-circle-outline",route:"accounts",children:[{title:"Người dùng",route:"/admin/accounts/user"},{title:"Khách hàng",route:"/admin/accounts/customer"},{title:"Cộng tác viên",route:"/admin/accounts/partner"},{title:"Quản trị viên",route:"/admin/accounts/admin"}]},{role:[i.ADMIN],title:"Thước phim",icon:"mdi-movie-open-outline",route:"videos",children:[{title:"Đang tạo",route:"/admin/videos/in-progress"},{title:"Tạo bị lỗi",route:"/admin/videos/error"},{title:"Hoàn thành",route:"/admin/videos/complete"}]},{role:[i.ADMIN],title:"Gói cho thuê",icon:"mdi-package-variant-closed",route:"/admin/service-rentals"},{role:[i.ADMIN],title:"Cài đặt",icon:"mdi-cog-outline",route:"settings",children:[]},{role:[i.PARTNER],title:"Tổng quan",icon:"mdi-view-dashboard-outline",route:"/partner"},{role:[i.PARTNER],title:"Quản lý giới thiệu",icon:"mdi-account-group-outline",route:"my-referral",children:[{title:"Người dùng",route:"/partner/my-referral/user"},{title:"Khách hàng",route:"/partner/my-referral/customer"}]},{role:[i.PARTNER],title:"Lịch sử giao dịch",icon:"mdi-cash-clock",route:"/partner/transaction-history"},{role:[i.PARTNER],title:"Thanh toán",icon:"mdi-credit-card-outline",route:"/partner/payment"},{role:[i.ADMIN,i.PARTNER],title:"Tool Video TN Solve",icon:"mdi-video-stabilization",route:"home"}].filter(c=>c.role?.includes(s.value?.role))),C=e=>{d.value=e},D=e=>{e.id==="home"?h.push(f("/")):e.id&&h.push(f(e.id))},a=()=>{J.logout().then(()=>{window.location.href="/"})};return F(()=>{for(const e of y.value)if(e.children&&e.children.find(N=>f(N.route)===v.fullPath)){g.value=[e.route];break}}),A({onDisplay:C}),(e,c)=>{const N=l("v-img"),I=l("v-avatar"),p=l("v-list-item"),V=l("v-divider"),z=l("v-list-group"),T=l("v-list"),E=l("v-navigation-drawer"),B=l("v-overlay");return u(),x(P,null,[n(E,{modelValue:t(d),"onUpdate:modelValue":c[1]||(c[1]=r=>$(d)?d.value=r:null),location:"left",width:"270",temporary:t(R)<1024,permanent:!(t(R)<1024),style:{background:"linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)","z-index":"9999"}},{prepend:o(()=>[n(p,{lines:"two"},{prepend:o(()=>[n(I,null,{default:o(()=>[n(N,{src:t(s)?.avatar||"/images/avatar-default.jpg","lazy-src":t(s)?.avatar||"/images/avatar-default.jpg"},{placeholder:o(()=>[n(N,{src:"/images/avatar-default.jpg"})]),_:1},8,["src","lazy-src"])]),_:1})]),default:o(()=>[m("div",ie,[m("span",null,b(t(s)?.name),1)])]),_:1}),n(V)]),append:o(()=>[n(T,{nav:""},{default:o(()=>[n(p,{"prepend-icon":"mdi-logout",value:"logout",class:"text-red bg-white",onClick:a},{default:o(()=>[m("span",null,b(e.$t("Đăng xuất")),1)]),_:1})]),_:1})]),default:o(()=>[n(T,{opened:t(g),"onUpdate:opened":c[0]||(c[0]=r=>$(g)?g.value=r:null),nav:"","open-strategy":"single","onClick:select":D},{default:o(()=>[(u(!0),x(P,null,G(t(y),(r,W)=>(u(),x(P,{key:W},[r?.children?(u(),_(z,{key:0,value:r.route},{activator:o(({props:w})=>[n(p,ee({ref_for:!0},w,{"prepend-icon":r.icon}),{default:o(()=>[m("span",null,b(e.$t(r.title)),1)]),_:2},1040,["prepend-icon"])]),default:o(()=>[(u(!0),x(P,null,G(r.children,(w,X)=>(u(),_(p,{key:X,color:"primary",active:t(f)(w.route)==t(v).fullPath,value:w.route},{default:o(()=>[m("span",null,b(e.$t(w.title)),1)]),_:2},1032,["active","value"]))),128))]),_:2},1032,["value"])):(u(),_(p,{key:1,color:"primary","prepend-icon":r.icon,value:r.route,active:t(f)(r.route)==t(v).fullPath},{default:o(()=>[m("span",null,b(e.$t(r.title)),1)]),_:2},1032,["prepend-icon","value","active"]))],64))),128))]),_:1},8,["opened"])]),_:1},8,["modelValue","temporary","permanent"]),t(S)?(u(),_(B,{key:0,modelValue:t(d),"onUpdate:modelValue":c[2]||(c[2]=r=>$(d)?d.value=r:null),style:{"z-index":"9 !important"}},null,8,["modelValue"])):U("",!0)],64)}}}),se={class:"header px-4"},ce={class:"d-flex align-center ga-2"},ue={class:"font-bold text-primary"},de={class:"ma-4"},me=L({__name:"AppSystem",setup(O){const A=j(),v=q();Q();const{t:h}=te(),{width:f}=H(),{onGetterUserData:R,onActionGetUserData:S}=K(),{onActionAllMasterDataClient:s}=re(),d=M(),g=M(!0);k(()=>A.meta.layout||"");const y=k(()=>R.value),C=k(()=>A.name?.toString().split("___")[0]),D=k(()=>{const a=A.matched.slice();return a.length===1&&a[0].path.includes("/admin/accounts")&&a.unshift({path:"/admin/accounts",meta:{title:h("Tài khoản")}}),a.length===1&&a[0].path.includes("/admin/videos")&&a.unshift({path:"/admin/videos",meta:{title:h("Thước phim")}}),a.length===1&&a[0].path.includes("/partner/my-referral")&&a.unshift({path:"/partner/my-referral",meta:{title:h("Quản lý giới thiệu")}}),[{disabled:!1,href:"/"},...a.map((e,c)=>({title:h(e.meta?.title||""),disabled:c===a.length-1}))]});return F(async()=>{try{await S().then(async()=>{await Promise.all([s({type:"dashboard",accountId:y.value?.role===i.ADMIN?A.query.id:null}),s({type:"transaction-months"})]),y.value?.role===i.ADMIN&&await Promise.all([s({type:"model-video"}),s({type:"frame-rate"}),s({type:"video-mode"}),s({type:"video-style"}),s({type:"video-duration"}),s({type:"rental-months"})])}).finally(()=>{[i.ADMIN,i.PARTNER].includes(y.value?.role)||v.push("/notfound")})}catch(a){console.error(a)}finally{setTimeout(()=>{g.value=!1},300)}}),(a,e)=>{const c=Y,N=Z,I=l("v-img"),p=l("v-icon"),V=l("v-btn"),z=l("v-breadcrumbs"),T=ne,E=l("v-main"),B=l("v-layout");return t(g)||!t(D)||!t(D).length?(u(),_(c,{key:0})):(u(),_(B,{key:1},{default:o(()=>[n(N),n(le,{ref_key:"drawerSystemRef",ref:d},null,512),n(E,null,{default:o(()=>[m("div",se,[m("div",ce,[n(I,{src:"/images/main-icon.png","lazy-src":"/images/tn-solve-icon.png",style:{width:"2.4rem"}}),m("h3",ue,b(t(y)?.role?.toUpperCase()),1)]),t(f)<1024?(u(),_(V,{key:0,icon:"",variant:"text",size:"44",style:{"margin-right":"-0.7rem"},onClick:e[0]||(e[0]=r=>t(d).onDisplay(!0))},{default:o(()=>[n(p,{size:"30"},{default:o(()=>[...e[1]||(e[1]=[oe("mdi-menu",-1)])]),_:1})]),_:1})):U("",!0)]),m("div",de,[["admin","partner"].includes(t(C)||"")?U("",!0):(u(),_(z,{key:0,items:t(D),class:"mb-4"},{prepend:o(()=>[n(p,{icon:"mdi-home-outline",size:"20"})]),_:1},8,["items"])),n(T)])]),_:1})]),_:1}))}}}),ye=ae(me,[["__scopeId","data-v-23f40e7d"]]);export{ye as A};
